<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Safely retry a request until it succeeds, as defined by the terminate_on
parameter, which by default means a response for which http_error()
is FALSE. Will also retry on error conditions raised by the underlying curl code,
but if the last retry still raises one, RETRY will raise it again with
stop().
It is designed to be kind to the server: after each failure
randomly waits up to twice as long. (Technically it uses exponential
backoff with jitter, using the approach outlined in
https://aws.amazon.com/blogs/architecture/exponential-backoff-and-jitter/.)
If the server returns status code 429 and specifies a retry-after value, that
value will be used instead, unless it's smaller than pause_min."><title>Retry a request until it succeeds. — RETRY • httr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Source%20Sans%20Pro-0.4.1/font.css" rel="stylesheet"><link href="../deps/_Source%20Code%20Pro-0.4.1/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Retry a request until it succeeds. — RETRY"><meta property="og:description" content="Safely retry a request until it succeeds, as defined by the terminate_on
parameter, which by default means a response for which http_error()
is FALSE. Will also retry on error conditions raised by the underlying curl code,
but if the last retry still raises one, RETRY will raise it again with
stop().
It is designed to be kind to the server: after each failure
randomly waits up to twice as long. (Technically it uses exponential
backoff with jitter, using the approach outlined in
https://aws.amazon.com/blogs/architecture/exponential-backoff-and-jitter/.)
If the server returns status code 429 and specifies a retry-after value, that
value will be used instead, unless it's smaller than pause_min."><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="httr.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-none"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">httr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.4.2.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/api-packages.html">Best practices for API packages</a>
    <a class="dropdown-item" href="../articles/quickstart.html">Getting started with httr</a>
    <a class="dropdown-item" href="../articles/secrets.html">Managing secrets</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <h6 class="dropdown-header" data-toc-skip>Releases</h6>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/12/httr-1-4-0/">Version 1.4.0</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-lib/httr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Retry a request until it succeeds.</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-lib/httr/blob/HEAD/R/retry.R" class="external-link"><code>R/retry.R</code></a></small>
      <div class="d-none name"><code>RETRY.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Safely retry a request until it succeeds, as defined by the <code>terminate_on</code>
parameter, which by default means a response for which <code><a href="http_error.html">http_error()</a></code>
is <code>FALSE</code>. Will also retry on error conditions raised by the underlying curl code,
but if the last retry still raises one, <code>RETRY</code> will raise it again with
<code><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop()</a></code>.
It is designed to be kind to the server: after each failure
randomly waits up to twice as long. (Technically it uses exponential
backoff with jitter, using the approach outlined in
<a href="https://aws.amazon.com/blogs/architecture/exponential-backoff-and-jitter/" class="external-link">https://aws.amazon.com/blogs/architecture/exponential-backoff-and-jitter/</a>.)
If the server returns status code 429 and specifies a <code>retry-after</code> value, that
value will be used instead, unless it's smaller than <code>pause_min</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">RETRY</span><span class="op">(</span>
  <span class="va">verb</span>,
  url <span class="op">=</span> <span class="cn">NULL</span>,
  config <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  <span class="va">...</span>,
  body <span class="op">=</span> <span class="cn">NULL</span>,
  encode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"multipart"</span>, <span class="st">"form"</span>, <span class="st">"json"</span>, <span class="st">"raw"</span><span class="op">)</span>,
  times <span class="op">=</span> <span class="fl">3</span>,
  pause_base <span class="op">=</span> <span class="fl">1</span>,
  pause_cap <span class="op">=</span> <span class="fl">60</span>,
  pause_min <span class="op">=</span> <span class="fl">1</span>,
  handle <span class="op">=</span> <span class="cn">NULL</span>,
  quiet <span class="op">=</span> <span class="cn">FALSE</span>,
  terminate_on <span class="op">=</span> <span class="cn">NULL</span>,
  terminate_on_success <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>verb</dt>
<dd><p>Name of verb to use.</p></dd>
<dt>url</dt>
<dd><p>the url of the page to retrieve</p></dd>
<dt>config</dt>
<dd><p>Additional configuration settings such as http
authentication (<code><a href="authenticate.html">authenticate()</a></code>), additional headers
(<code><a href="add_headers.html">add_headers()</a></code>), cookies (<code><a href="set_cookies.html">set_cookies()</a></code>) etc.
See <code><a href="config.html">config()</a></code> for full details and list of helpers.</p></dd>
<dt>...</dt>
<dd><p>Further named parameters, such as <code>query</code>, <code>path</code>, etc,
passed on to <code><a href="modify_url.html">modify_url()</a></code>. Unnamed parameters will be combined
with <code><a href="config.html">config()</a></code>.</p></dd>
<dt>body</dt>
<dd><p>One of the following:</p><ul><li><p><code>FALSE</code>: No body. This is typically not used with <code>POST</code>,
<code>PUT</code>, or <code>PATCH</code>, but can be useful if you need to send a
bodyless request (like <code>GET</code>) with <code><a href="VERB.html">VERB()</a></code>.</p></li>
<li><p><code>NULL</code>: An empty body</p></li>
<li><p><code>""</code>: A length 0 body</p></li>
<li><p><code>upload_file("path/")</code>: The contents of a file.  The mime
type will be guessed from the extension, or can be supplied explicitly
as the second argument to <code><a href="upload_file.html">upload_file()</a></code></p></li>
<li><p>A character or raw vector: sent as is in body. Use
<code><a href="content_type.html">content_type()</a></code> to tell the server what sort of data
you are sending.</p></li>
<li><p>A named list: See details for encode.</p></li>
</ul></dd>
<dt>encode</dt>
<dd><p>If the body is a named list, how should it be encoded? Can be
one of form (application/x-www-form-urlencoded), multipart,
(multipart/form-data), or json (application/json).</p>
<p>For "multipart", list elements can be strings or objects created by
<code><a href="upload_file.html">upload_file()</a></code>. For "form", elements are coerced to strings
and escaped, use <code><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I()</a></code> to prevent double-escaping. For "json",
parameters are automatically "unboxed" (i.e. length 1 vectors are
converted to scalars). To preserve a length 1 vector as a vector,
wrap in <code><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I()</a></code>. For "raw", either a character or raw vector. You'll
need to make sure to set the <code><a href="content_type.html">content_type()</a></code> yourself.</p></dd>
<dt>times</dt>
<dd><p>Maximum number of requests to attempt.</p></dd>
<dt>pause_base, pause_cap</dt>
<dd><p>This method uses exponential back-off with
full jitter - this means that each request will randomly wait between 0
and <code>pause_base * 2 ^ attempt</code> seconds, up to a maximum of
<code>pause_cap</code> seconds.</p></dd>
<dt>pause_min</dt>
<dd><p>Minimum time to wait in the backoff; generally
only necessary if you need pauses less than one second (which may
not be kind to the server, use with caution!).</p></dd>
<dt>handle</dt>
<dd><p>The handle to use with this request. If not
supplied, will be retrieved and reused from the <code><a href="handle_pool.html">handle_pool()</a></code>
based on the scheme, hostname and port of the url. By default <span class="pkg">httr</span>
requests to the same scheme/host/port combo. This substantially reduces
connection time, and ensures that cookies are maintained over multiple
requests to the same host. See <code><a href="handle_pool.html">handle_pool()</a></code> for more
details.</p></dd>
<dt>quiet</dt>
<dd><p>If <code>FALSE</code>, will print a message displaying how long
until the next request.</p></dd>
<dt>terminate_on</dt>
<dd><p>Optional vector of numeric HTTP status codes that if found
on the response will terminate the retry process. If <code>NULL</code>, will keep
retrying while <code><a href="http_error.html">http_error()</a></code> is <code>TRUE</code> for the response.</p></dd>
<dt>terminate_on_success</dt>
<dd><p>If <code>TRUE</code>, the default, this will
automatically terminate when the request is successful, regardless of the
value of <code>terminate_on</code>.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The last response. Note that if the request doesn't succeed after
<code>times</code> times this will be a failed request, i.e. you still need
to use <code><a href="stop_for_status.html">stop_for_status()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># Succeeds straight away</span></span>
<span class="r-in"><span class="fu">RETRY</span><span class="op">(</span><span class="st">"GET"</span>, <span class="st">"http://httpbin.org/status/200"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response [http://httpbin.org/status/200]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Date: 2022-05-03 20:43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Status: 200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Content-Type: text/html; charset=utf-8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;EMPTY BODY&gt;</span>
<span class="r-in"><span class="co"># Never succeeds</span></span>
<span class="r-in"><span class="fu">RETRY</span><span class="op">(</span><span class="st">"GET"</span>, <span class="st">"http://httpbin.org/status/500"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Request failed [500]. Retrying in 1.5 seconds...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Request failed [500]. Retrying in 2.6 seconds...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Response [http://httpbin.org/status/500]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Date: 2022-05-03 20:43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Status: 500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Content-Type: text/html; charset=utf-8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;EMPTY BODY&gt;</span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># Invalid hostname generates curl error condition and is retried but eventually</span></span>
<span class="r-in"><span class="co"># raises an error condition.</span></span>
<span class="r-in"><span class="fu">RETRY</span><span class="op">(</span><span class="st">"GET"</span>, <span class="st">"http://invalidhostname/"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="http://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://www.rstudio.com" class="external-link"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" width="72"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

  </div></footer></body></html>

