<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Best practices for API packages • httr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Best practices for API packages">
<meta property="og:description" content="httr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">httr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/quickstart.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/secrets.html">Managing secrets</a>
    </li>
    <li>
      <a href="../articles/api-packages.html">Best practices for API packages</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.tidyverse.org/articles/2018/12/httr-1-4-0/">Version 1.4.0</a>
    </li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/r-lib/httr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="api-packages_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Best practices for API packages</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-lib/httr/blob/master/vignettes/api-packages.Rmd"><code>vignettes/api-packages.Rmd</code></a></small>
      <div class="hidden name"><code>api-packages.Rmd</code></div>

    </div>

    
    
<p>So you want to write an R client for a web API? This document walks through the key issues involved in writing API wrappers in R. If you’re new to working with web APIs, you may want to start by reading “<a href="https://zapier.com/learn/apis">An introduction to APIs</a>” by zapier.</p>
<div id="overall-design" class="section level2">
<h2 class="hasAnchor">
<a href="#overall-design" class="anchor"></a>Overall design</h2>
<p>APIs vary widely. Before starting to code, it is important to understand how the API you are working with handles important issues so that you can implement a complete and coherent R client for the API.</p>
<p>The key features of any API are the structure of the requests and the structure of the responses. An HTTP request consists of the following parts:</p>
<ol style="list-style-type: decimal">
<li>HTTP verb (<code>GET</code>, <code>POST</code>, <code>DELETE</code>, etc.)</li>
<li>The base URL for the API</li>
<li>The URL path or endpoint</li>
<li>URL query arguments (e.g., <code>?foo=bar</code>)</li>
<li>Optional headers</li>
<li>An optional request body</li>
</ol>
<p>An API package needs to be able to generate these components in order to perform the desired API call, which will typically involve some sort of authentication.</p>
<p>For example, to request that the GitHub API provides a list of all issues for the httr repo, we send an HTTP request that looks like:</p>
<pre><code>-&gt; GET /repos/hadley/httr HTTP/1.1
-&gt; Host: api.github.com
-&gt; Accept: application/vnd.github.v3+json</code></pre>
<p>Here we’re using a <code>GET</code> request to the host <code>api.github.com</code>. The url is <code>/repos/hadley/httr</code>, and we send an accept header that tells GitHub what sort of data we want.</p>
<p>In response to this request, the API will return an HTTP response that includes:</p>
<ol style="list-style-type: decimal">
<li>An HTTP status code.</li>
<li>Headers, key-value pairs.</li>
<li>A body typically consisting of XML, JSON, plain text, HTML, or some kind of binary representation.</li>
</ol>
<p>An API client needs to parse these responses, turning API errors into R errors, and return a useful object to the end user. For the previous HTTP request, GitHub returns:</p>
<pre><code>&lt;- HTTP/1.1 200 OK
&lt;- Server: GitHub.com
&lt;- Content-Type: application/json; charset=utf-8
&lt;- X-RateLimit-Limit: 5000
&lt;- X-RateLimit-Remaining: 4998
&lt;- X-RateLimit-Reset: 1459554901
&lt;- 
&lt;- {
&lt;-   "id": 2756403,
&lt;-   "name": "httr",
&lt;-   "full_name": "hadley/httr",
&lt;-   "owner": {
&lt;-     "login": "hadley",
&lt;-     "id": 4196,
&lt;-     "avatar_url": "https://avatars.githubusercontent.com/u/4196?v=3",
&lt;-     ...
&lt;-   },
&lt;-   "private": false,
&lt;-   "html_url": "https://github.com/hadley/httr",
&lt;-   "description": "httr: a friendly http package for R",
&lt;-   "fork": false,
&lt;-   "url": "https://api.github.com/repos/hadley/httr",
&lt;-   ...
&lt;-   "network_count": 1368,
&lt;-   "subscribers_count": 64
&lt;- }</code></pre>
<p>Designing a good API client requires identifying how each of these API features is used to compose a request and what type of response is expected for each. It’s best practice to insulate the end user from <em>how</em> the API works so they only need to understand how to use an R function, not the details of how APIs work. It’s your job to suffer so that others don’t have to!</p>
</div>
<div id="first-steps" class="section level2">
<h2 class="hasAnchor">
<a href="#first-steps" class="anchor"></a>First steps</h2>
<div id="send-a-simple-request" class="section level3">
<h3 class="hasAnchor">
<a href="#send-a-simple-request" class="anchor"></a>Send a simple request</h3>
<p>First, find a simple API endpoint that doesn’t require authentication: this lets you get the basics working before tackling the complexities of authentication. For this example, we’ll use the list of httr issues which requires sending a GET request to <code>repos/hadley/httr</code>:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">httr</span>)
<span class="no">github_api</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">path</span>) {
  <span class="no">url</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/modify_url.html">modify_url</a></span>(<span class="st">"https://api.github.com"</span>, <span class="kw">path</span> <span class="kw">=</span> <span class="no">path</span>)
  <span class="fu"><a href="../reference/GET.html">GET</a></span>(<span class="no">url</span>)
}

<span class="no">resp</span> <span class="kw">&lt;-</span> <span class="fu">github_api</span>(<span class="st">"/repos/hadley/httr"</span>)
<span class="no">resp</span>
<span class="co">#&gt; Response [https://api.github.com/repositories/2756403]</span>
<span class="co">#&gt;   Date: 2020-07-20 13:23</span>
<span class="co">#&gt;   Status: 200</span>
<span class="co">#&gt;   Content-Type: application/json; charset=utf-8</span>
<span class="co">#&gt;   Size: 6.07 kB</span>
<span class="co">#&gt; {</span>
<span class="co">#&gt;   "id": 2756403,</span>
<span class="co">#&gt;   "node_id": "MDEwOlJlcG9zaXRvcnkyNzU2NDAz",</span>
<span class="co">#&gt;   "name": "httr",</span>
<span class="co">#&gt;   "full_name": "r-lib/httr",</span>
<span class="co">#&gt;   "private": false,</span>
<span class="co">#&gt;   "owner": {</span>
<span class="co">#&gt;     "login": "r-lib",</span>
<span class="co">#&gt;     "id": 22618716,</span>
<span class="co">#&gt;     "node_id": "MDEyOk9yZ2FuaXphdGlvbjIyNjE4NzE2",</span>
<span class="co">#&gt; ...</span></pre></body></html></div>
</div>
<div id="parse-the-response" class="section level3">
<h3 class="hasAnchor">
<a href="#parse-the-response" class="anchor"></a>Parse the response</h3>
<p>Next, you need to take the response returned by the API and turn it into a useful object. Any API will return an HTTP response that consists of headers and a body. While the response can come in multiple forms (see above), two of the most common structured formats are XML and JSON.</p>
<p>Note that while most APIs will return only one or the other, some, like the colour lovers API, allow you to choose which one with a url parameter:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="../reference/GET.html">GET</a></span>(<span class="st">"http://www.colourlovers.com/api/color/6B4106?format=xml"</span>)
<span class="co">#&gt; Response [http://www.colourlovers.com/api/color/6B4106?format=xml]</span>
<span class="co">#&gt;   Date: 2020-07-20 13:23</span>
<span class="co">#&gt;   Status: 200</span>
<span class="co">#&gt;   Content-Type: text/xml; charset=utf-8</span>
<span class="co">#&gt;   Size: 1.8 kB</span>
<span class="co">#&gt; &lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span>
<span class="co">#&gt; &lt;colors numResults="1" totalResults="10075142"&gt;</span>
<span class="co">#&gt;  &lt;color&gt;</span>
<span class="co">#&gt;      &lt;id&gt;903893&lt;/id&gt;</span>
<span class="co">#&gt;      &lt;title&gt;&lt;![CDATA[wet dirt]]&gt;&lt;/title&gt;</span>
<span class="co">#&gt;      &lt;userName&gt;&lt;![CDATA[jessicabrown]]&gt;&lt;/userName&gt;</span>
<span class="co">#&gt;      &lt;numViews&gt;597&lt;/numViews&gt;</span>
<span class="co">#&gt;      &lt;numVotes&gt;1&lt;/numVotes&gt;</span>
<span class="co">#&gt;      &lt;numComments&gt;0&lt;/numComments&gt;</span>
<span class="co">#&gt;      &lt;numHearts&gt;0&lt;/numHearts&gt;</span>
<span class="co">#&gt; ...</span>
<span class="fu"><a href="../reference/GET.html">GET</a></span>(<span class="st">"http://www.colourlovers.com/api/color/6B4106?format=json"</span>)
<span class="co">#&gt; Response [http://www.colourlovers.com/api/color/6B4106?format=json]</span>
<span class="co">#&gt;   Date: 2020-07-20 13:23</span>
<span class="co">#&gt;   Status: 200</span>
<span class="co">#&gt;   Content-Type: application/json; charset=utf-8</span>
<span class="co">#&gt;   Size: 1.43 kB</span></pre></body></html></div>
<p>Others use <a href="http://en.wikipedia.org/wiki/Content_negotiation">content negotiation</a> to determine what sort of data to send back. If the API you’re wrapping does this, then you’ll need to include one of <code><a href="../reference/content_type.html">accept_json()</a></code> and <code><a href="../reference/content_type.html">accept_xml()</a></code> in your request.</p>
<p>If you have a choice, choose json: it’s usually much easier to work with than xml.</p>
<p>Most APIs will return most or all useful information in the response body, which can be accessed using <code><a href="../reference/content.html">content()</a></code>. To determine what type of information is returned, you can use <code><a href="../reference/http_type.html">http_type()</a></code></p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="../reference/http_type.html">http_type</a></span>(<span class="no">resp</span>)
<span class="co">#&gt; [1] "application/json"</span></pre></body></html></div>
<p>I recommend checking that the type is as you expect in your helper function. This will ensure that you get a clear error message if the API changes:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">github_api</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">path</span>) {
  <span class="no">url</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/modify_url.html">modify_url</a></span>(<span class="st">"https://api.github.com"</span>, <span class="kw">path</span> <span class="kw">=</span> <span class="no">path</span>)

  <span class="no">resp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/GET.html">GET</a></span>(<span class="no">url</span>)
  <span class="kw">if</span> (<span class="fu"><a href="../reference/http_type.html">http_type</a></span>(<span class="no">resp</span>) <span class="kw">!=</span> <span class="st">"application/json"</span>) {
    <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"API did not return json"</span>, <span class="kw">call.</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
  }

  <span class="no">resp</span>
}</pre></body></html></div>
<p>NB: some poorly written APIs will say the content is type A, but it will actually be type B. In this case you should complain to the API authors, and until they fix the problem, simply drop the check for content type.</p>
<p>Next we need to parse the output into an R object. httr provides some default parsers with <code><a href="../reference/content.html">content(..., as = "auto")</a></code> but I don’t recommend using them inside a package. Instead it’s better to explicitly parse it yourself:</p>
<ol style="list-style-type: decimal">
<li>To parse json, use <code>jsonlite</code> package.</li>
<li>To parse xml, use the <code>xml2</code> package.</li>
</ol>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">github_api</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">path</span>) {
  <span class="no">url</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/modify_url.html">modify_url</a></span>(<span class="st">"https://api.github.com"</span>, <span class="kw">path</span> <span class="kw">=</span> <span class="no">path</span>)

  <span class="no">resp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/GET.html">GET</a></span>(<span class="no">url</span>)
  <span class="kw">if</span> (<span class="fu"><a href="../reference/http_type.html">http_type</a></span>(<span class="no">resp</span>) <span class="kw">!=</span> <span class="st">"application/json"</span>) {
    <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"API did not return json"</span>, <span class="kw">call.</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
  }

  <span class="kw pkg">jsonlite</span><span class="kw ns">::</span><span class="fu"><a href="https://jeroen.cran.dev/jsonlite/reference/fromJSON.html">fromJSON</a></span>(<span class="fu"><a href="../reference/content.html">content</a></span>(<span class="no">resp</span>, <span class="st">"text"</span>), <span class="kw">simplifyVector</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
}</pre></body></html></div>
</div>
<div id="return-a-helpful-object" class="section level3">
<h3 class="hasAnchor">
<a href="#return-a-helpful-object" class="anchor"></a>Return a helpful object</h3>
<p>Rather than simply returning the response as a list, I think it’s a good practice to make a simple S3 object. That way you can return the response and parsed object, and provide a nice print method. This will make debugging later on much much much more pleasant.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">github_api</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">path</span>) {
  <span class="no">url</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/modify_url.html">modify_url</a></span>(<span class="st">"https://api.github.com"</span>, <span class="kw">path</span> <span class="kw">=</span> <span class="no">path</span>)

  <span class="no">resp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/GET.html">GET</a></span>(<span class="no">url</span>)
  <span class="kw">if</span> (<span class="fu"><a href="../reference/http_type.html">http_type</a></span>(<span class="no">resp</span>) <span class="kw">!=</span> <span class="st">"application/json"</span>) {
    <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"API did not return json"</span>, <span class="kw">call.</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
  }

  <span class="no">parsed</span> <span class="kw">&lt;-</span> <span class="kw pkg">jsonlite</span><span class="kw ns">::</span><span class="fu"><a href="https://jeroen.cran.dev/jsonlite/reference/fromJSON.html">fromJSON</a></span>(<span class="fu"><a href="../reference/content.html">content</a></span>(<span class="no">resp</span>, <span class="st">"text"</span>), <span class="kw">simplifyVector</span> <span class="kw">=</span> <span class="fl">FALSE</span>)

  <span class="fu"><a href="https://rdrr.io/r/base/structure.html">structure</a></span>(
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
      <span class="kw">content</span> <span class="kw">=</span> <span class="no">parsed</span>,
      <span class="kw">path</span> <span class="kw">=</span> <span class="no">path</span>,
      <span class="kw">response</span> <span class="kw">=</span> <span class="no">resp</span>
    ),
    <span class="kw">class</span> <span class="kw">=</span> <span class="st">"github_api"</span>
  )
}

<span class="no">print.github_api</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>, <span class="no">...</span>) {
  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"&lt;GitHub "</span>, <span class="no">x</span>$<span class="no">path</span>, <span class="st">"&gt;\n"</span>, <span class="kw">sep</span> <span class="kw">=</span> <span class="st">""</span>)
  <span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">x</span>$<span class="no">content</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span>(<span class="no">x</span>)
}

<span class="fu">github_api</span>(<span class="st">"/users/hadley"</span>)
<span class="co">#&gt; &lt;GitHub /users/hadley&gt;</span>
<span class="co">#&gt; List of 32</span>
<span class="co">#&gt;  $ login              : chr "hadley"</span>
<span class="co">#&gt;  $ id                 : int 4196</span>
<span class="co">#&gt;  $ node_id            : chr "MDQ6VXNlcjQxOTY="</span>
<span class="co">#&gt;  $ avatar_url         : chr "https://avatars3.githubusercontent.com/u/4196?v=4"</span>
<span class="co">#&gt;  $ gravatar_id        : chr ""</span>
<span class="co">#&gt;  $ url                : chr "https://api.github.com/users/hadley"</span>
<span class="co">#&gt;  $ html_url           : chr "https://github.com/hadley"</span>
<span class="co">#&gt;  $ followers_url      : chr "https://api.github.com/users/hadley/followers"</span>
<span class="co">#&gt;  $ following_url      : chr "https://api.github.com/users/hadley/following{/other_user}"</span>
<span class="co">#&gt;  $ gists_url          : chr "https://api.github.com/users/hadley/gists{/gist_id}"</span>
<span class="co">#&gt;  $ starred_url        : chr "https://api.github.com/users/hadley/starred{/owner}{/repo}"</span>
<span class="co">#&gt;  $ subscriptions_url  : chr "https://api.github.com/users/hadley/subscriptions"</span>
<span class="co">#&gt;  $ organizations_url  : chr "https://api.github.com/users/hadley/orgs"</span>
<span class="co">#&gt;  $ repos_url          : chr "https://api.github.com/users/hadley/repos"</span>
<span class="co">#&gt;  $ events_url         : chr "https://api.github.com/users/hadley/events{/privacy}"</span>
<span class="co">#&gt;  $ received_events_url: chr "https://api.github.com/users/hadley/received_events"</span>
<span class="co">#&gt;  $ type               : chr "User"</span>
<span class="co">#&gt;  $ site_admin         : logi FALSE</span>
<span class="co">#&gt;  $ name               : chr "Hadley Wickham"</span>
<span class="co">#&gt;  $ company            : chr "@rstudio "</span>
<span class="co">#&gt;  $ blog               : chr "http://hadley.nz"</span>
<span class="co">#&gt;  $ location           : chr "Houston, TX"</span>
<span class="co">#&gt;  $ email              : NULL</span>
<span class="co">#&gt;  $ hireable           : NULL</span>
<span class="co">#&gt;  $ bio                : chr "Chief Scientist at @rstudio"</span>
<span class="co">#&gt;  $ twitter_username   : chr "hadleywickham"</span>
<span class="co">#&gt;  $ public_repos       : int 272</span>
<span class="co">#&gt;  $ public_gists       : int 175</span>
<span class="co">#&gt;  $ followers          : int 19040</span>
<span class="co">#&gt;  $ following          : int 6</span>
<span class="co">#&gt;  $ created_at         : chr "2008-04-01T14:47:36Z"</span>
<span class="co">#&gt;  $ updated_at         : chr "2020-07-20T12:31:14Z"</span></pre></body></html></div>
<p>The API might return invalid data, but this should be rare, so you can just rely on the parser to provide a useful error message.</p>
</div>
<div id="turn-api-errors-into-r-errors" class="section level3">
<h3 class="hasAnchor">
<a href="#turn-api-errors-into-r-errors" class="anchor"></a>Turn API errors into R errors</h3>
<p>Next, you need to make sure that your API wrapper throws an error if the request failed. Using a web API introduces additional possible points of failure into R code aside from those occurring in R itself. These include:</p>
<ul>
<li>Client-side exceptions</li>
<li>Network / communication exceptions</li>
<li>Server-side exceptions</li>
</ul>
<p>You need to make sure these are all converted into regular R errors. You can figure out if there’s a problem with <code><a href="../reference/http_error.html">http_error()</a></code>, which checks the HTTP status code. Status codes in the 400 range usually mean that you’ve done something wrong. Status codes in the 500 range typically mean that something has gone wrong on the server side.</p>
<p>Often the API will provide information about the error in the body of the response: you should use this where available. If the API returns special errors for common problems, you might want to provide more detail in the error. For example, if you run out of requests and are <a href="https://developer.github.com/v3/#rate-limiting">rate limited</a> you might want to tell the user how long to wait until they can make the next request (or even automatically wait that long!).</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">github_api</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">path</span>) {
  <span class="no">url</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/modify_url.html">modify_url</a></span>(<span class="st">"https://api.github.com"</span>, <span class="kw">path</span> <span class="kw">=</span> <span class="no">path</span>)

  <span class="no">resp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/GET.html">GET</a></span>(<span class="no">url</span>)
  <span class="kw">if</span> (<span class="fu"><a href="../reference/http_type.html">http_type</a></span>(<span class="no">resp</span>) <span class="kw">!=</span> <span class="st">"application/json"</span>) {
    <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"API did not return json"</span>, <span class="kw">call.</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
  }

  <span class="no">parsed</span> <span class="kw">&lt;-</span> <span class="kw pkg">jsonlite</span><span class="kw ns">::</span><span class="fu"><a href="https://jeroen.cran.dev/jsonlite/reference/fromJSON.html">fromJSON</a></span>(<span class="fu"><a href="../reference/content.html">content</a></span>(<span class="no">resp</span>, <span class="st">"text"</span>), <span class="kw">simplifyVector</span> <span class="kw">=</span> <span class="fl">FALSE</span>)

  <span class="kw">if</span> (<span class="fu"><a href="../reference/http_error.html">http_error</a></span>(<span class="no">resp</span>)) {
    <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(
      <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(
        <span class="st">"GitHub API request failed [%s]\n%s\n&lt;%s&gt;"</span>,
        <span class="fu"><a href="../reference/status_code.html">status_code</a></span>(<span class="no">resp</span>),
        <span class="no">parsed</span>$<span class="no">message</span>,
        <span class="no">parsed</span>$<span class="no">documentation_url</span>
      ),
      <span class="kw">call.</span> <span class="kw">=</span> <span class="fl">FALSE</span>
    )
  }

  <span class="fu"><a href="https://rdrr.io/r/base/structure.html">structure</a></span>(
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
      <span class="kw">content</span> <span class="kw">=</span> <span class="no">parsed</span>,
      <span class="kw">path</span> <span class="kw">=</span> <span class="no">path</span>,
      <span class="kw">response</span> <span class="kw">=</span> <span class="no">resp</span>
    ),
    <span class="kw">class</span> <span class="kw">=</span> <span class="st">"github_api"</span>
  )
}
<span class="fu">github_api</span>(<span class="st">"/user/hadley"</span>)
<span class="co">#&gt; Error: GitHub API request failed [404]</span>
<span class="co">#&gt; Not Found</span>
<span class="co">#&gt; &lt;https://developer.github.com/v3/users/#get-a-single-user&gt;</span></pre></body></html></div>
<blockquote>
<p>Some poorly written APIs will return different types of response based on whether or not the request succeeded or failed. If your API does this you’ll need to make your request function check the <code><a href="../reference/status_code.html">status_code()</a></code> before parsing the response.</p>
</blockquote>
<p>For many APIs, the common approach is to retry API calls that return something in the 500 range. However, when doing this, it’s <strong>extremely</strong> important to make sure to do this with some form of exponential backoff: if something’s wrong on the server-side, hammering the server with retries may make things worse, and may lead to you exhausting quota (or hitting other sorts of rate limits). A common policy is to retry up to 5 times, starting at 1s, and each time doubling and adding a small amount of jitter (plus or minus up to, say, 5% of the current wait time).</p>
</div>
<div id="set-a-user-agent" class="section level3">
<h3 class="hasAnchor">
<a href="#set-a-user-agent" class="anchor"></a>Set a user agent</h3>
<p>While we’re in this function, there’s one important header that you should set for every API wrapper: the user agent. The user agent is a string used to identify the client. This is most useful for the API owner as it allows them to see who is using the API. It’s also useful for you if you have a contact on the inside as it often makes it easier for them to pull your requests from their logs and see what’s going wrong. If you’re hitting a commercial API, this also makes it easier for internal R advocates to see how many people are using their API via R and hopefully assign more resources.</p>
<p>A good default for an R API package wrapper is to make it the URL to your GitHub repo:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">ua</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/user_agent.html">user_agent</a></span>(<span class="st">"http://github.com/hadley/httr"</span>)
<span class="no">ua</span>
<span class="co">#&gt; &lt;request&gt;</span>
<span class="co">#&gt; Options:</span>
<span class="co">#&gt; * useragent: http://github.com/hadley/httr</span>

<span class="no">github_api</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">path</span>) {
  <span class="no">url</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/modify_url.html">modify_url</a></span>(<span class="st">"https://api.github.com"</span>, <span class="kw">path</span> <span class="kw">=</span> <span class="no">path</span>)

  <span class="no">resp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/GET.html">GET</a></span>(<span class="no">url</span>, <span class="no">ua</span>)
  <span class="kw">if</span> (<span class="fu"><a href="../reference/http_type.html">http_type</a></span>(<span class="no">resp</span>) <span class="kw">!=</span> <span class="st">"application/json"</span>) {
    <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"API did not return json"</span>, <span class="kw">call.</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
  }

  <span class="no">parsed</span> <span class="kw">&lt;-</span> <span class="kw pkg">jsonlite</span><span class="kw ns">::</span><span class="fu"><a href="https://jeroen.cran.dev/jsonlite/reference/fromJSON.html">fromJSON</a></span>(<span class="fu"><a href="../reference/content.html">content</a></span>(<span class="no">resp</span>, <span class="st">"text"</span>), <span class="kw">simplifyVector</span> <span class="kw">=</span> <span class="fl">FALSE</span>)

  <span class="kw">if</span> (<span class="fu"><a href="../reference/status_code.html">status_code</a></span>(<span class="no">resp</span>) <span class="kw">!=</span> <span class="fl">200</span>) {
    <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(
      <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(
        <span class="st">"GitHub API request failed [%s]\n%s\n&lt;%s&gt;"</span>,
        <span class="fu"><a href="../reference/status_code.html">status_code</a></span>(<span class="no">resp</span>),
        <span class="no">parsed</span>$<span class="no">message</span>,
        <span class="no">parsed</span>$<span class="no">documentation_url</span>
      ),
      <span class="kw">call.</span> <span class="kw">=</span> <span class="fl">FALSE</span>
    )
  }

  <span class="fu"><a href="https://rdrr.io/r/base/structure.html">structure</a></span>(
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
      <span class="kw">content</span> <span class="kw">=</span> <span class="no">parsed</span>,
      <span class="kw">path</span> <span class="kw">=</span> <span class="no">path</span>,
      <span class="kw">response</span> <span class="kw">=</span> <span class="no">resp</span>
    ),
    <span class="kw">class</span> <span class="kw">=</span> <span class="st">"github_api"</span>
  )
}</pre></body></html></div>
</div>
<div id="passing-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#passing-parameters" class="anchor"></a>Passing parameters</h3>
<p>Most APIs work by executing an HTTP method on a specified URL with some additional parameters. These parameters can be specified in a number of ways, including in the URL path, in URL query arguments, in HTTP headers, and in the request body itself. These parameters can be controlled using httr functions:</p>
<ol style="list-style-type: decimal">
<li>URL path: <code><a href="../reference/modify_url.html">modify_url()</a></code>
</li>
<li>Query arguments: The <code>query</code> argument to <code><a href="../reference/GET.html">GET()</a></code>, <code><a href="../reference/POST.html">POST()</a></code>, etc.</li>
<li>HTTP headers: <code><a href="../reference/add_headers.html">add_headers()</a></code>
</li>
<li>Request body: The <code>body</code> argument to <code><a href="../reference/GET.html">GET()</a></code>, <code><a href="../reference/POST.html">POST()</a></code>, etc.</li>
</ol>
<p><a href="https://en.wikipedia.org/wiki/Representational_state_transfer">RESTful APIs</a> also use the HTTP verb to communicate arguments (e.g., <code>GET</code> retrieves a file, <code>POST</code> adds a file, <code>DELETE</code> removes a file, etc.). We can use the helpful <a href="http://httpbin.org">httpbin service</a> to show how to send arguments in each of these ways.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="co"># modify_url</span>
<span class="fu"><a href="../reference/POST.html">POST</a></span>(<span class="fu"><a href="../reference/modify_url.html">modify_url</a></span>(<span class="st">"https://httpbin.org"</span>, <span class="kw">path</span> <span class="kw">=</span> <span class="st">"/post"</span>))

<span class="co"># query arguments</span>
<span class="fu"><a href="../reference/POST.html">POST</a></span>(<span class="st">"http://httpbin.org/post"</span>, <span class="kw">query</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">foo</span> <span class="kw">=</span> <span class="st">"bar"</span>))

<span class="co"># headers</span>
<span class="fu"><a href="../reference/POST.html">POST</a></span>(<span class="st">"http://httpbin.org/post"</span>, <span class="fu"><a href="../reference/add_headers.html">add_headers</a></span>(<span class="kw">foo</span> <span class="kw">=</span> <span class="st">"bar"</span>))

<span class="co"># body</span>
<span class="co">## as form</span>
<span class="fu"><a href="../reference/POST.html">POST</a></span>(<span class="st">"http://httpbin.org/post"</span>, <span class="kw">body</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">foo</span> <span class="kw">=</span> <span class="st">"bar"</span>), <span class="kw">encode</span> <span class="kw">=</span> <span class="st">"form"</span>)
<span class="co">## as json</span>
<span class="fu"><a href="../reference/POST.html">POST</a></span>(<span class="st">"http://httpbin.org/post"</span>, <span class="kw">body</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">foo</span> <span class="kw">=</span> <span class="st">"bar"</span>), <span class="kw">encode</span> <span class="kw">=</span> <span class="st">"json"</span>)</pre></body></html></div>
<p>Many APIs will use just one of these forms of argument passing, but others will use multiple of them in combination. Best practice is to insulate the user from how and where the various arguments are used by the API and instead simply expose relevant arguments via R function arguments, some of which might be used in the URL, in the headers, in the body, etc.</p>
<p>If a parameter has a small fixed set of possible values that are allowed by the API, you can use list them in the default arguments and then use <code><a href="https://rdrr.io/r/base/match.arg.html">match.arg()</a></code> to ensure that the caller only supplies one of those values. (This also allows the user to supply the short unique prefixes.)</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="no">f</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"apple"</span>, <span class="st">"banana"</span>, <span class="st">"orange"</span>)) {
  <span class="fu"><a href="https://rdrr.io/r/base/match.arg.html">match.arg</a></span>(<span class="no">x</span>)
}
<span class="fu">f</span>(<span class="st">"a"</span>)
<span class="co">#&gt; [1] "apple"</span></pre></body></html></div>
<p>It is good practice to explicitly set default values for arguments that are not required to <code>NULL</code>. If there is a default value, it should be the first one listed in the vector of allowed arguments.</p>
</div>
</div>
<div id="authentication" class="section level2">
<h2 class="hasAnchor">
<a href="#authentication" class="anchor"></a>Authentication</h2>
<p>Many APIs can be called without any authentication (just as if you called them in a web browser). However, others require authentication to perform particular requests or to avoid rate limits and other limitations. The most common forms of authentication are OAuth and HTTP basic authentication:</p>
<ol style="list-style-type: decimal">
<li><p><em>“Basic” authentication</em>: This requires a username and password (or sometimes just a username). This is passed as part of the HTTP request. In httr, you can do: <code><a href="../reference/GET.html">GET("http://httpbin.org", authenticate("username", "password"))</a></code></p></li>
<li>
<p><em>Basic authentication with an API key</em>: An alternative provided by many APIs is an API “key” or “token” which is passed as part of the request. It is better than a username/password combination because it can be regenerated independent of the username and password.</p>
<p>This API key can be specified in a number of different ways: in a URL query argument, in an HTTP header such as the <code>Authorization</code> header, or in an argument inside the request body.</p>
</li>
<li><p><em>OAuth</em>: OAuth is a protocol for generating a user- or session-specific authentication token to use in subsequent requests. (An early standard, OAuth 1.0, is not terribly common any more. See <code><a href="../reference/oauth1.0_token.html">oauth1.0_token()</a></code> for details.) The current OAuth 2.0 standard is very common in modern web apps. It involves a round trip between the client and server to establish if the API client has the authority to access the data. See <code><a href="../reference/oauth2.0_token.html">oauth2.0_token()</a></code>. It’s ok to publish the app ID and app “secret” - these are not actually important for security of user data.</p></li>
</ol>
<blockquote>
<p>Some APIs describe their authentication processes inaccurately, so care needs to be taken to understand the true authentication mechanism regardless of the label used in the API docs.</p>
</blockquote>
<p>It is possible to specify the key(s) or token(s) required for basic or OAuth authentication in a number of different ways. You may also need some way to preserve user credentials between function calls so that end users do not need to specify them each time. A good start is to use an environment variable. Here is an example of how to write a function that checks for the presence of a GitHub personal access token and errors otherwise:</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">github_pat</span> <span class="kw">&lt;-</span> <span class="kw">function</span>() {
  <span class="no">pat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span>(<span class="st">'GITHUB_PAT'</span>)
  <span class="kw">if</span> (<span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span>(<span class="no">pat</span>, <span class="st">""</span>)) {
    <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"Please set env var GITHUB_PAT to your github personal access token"</span>,
      <span class="kw">call.</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
  }

  <span class="no">pat</span>
}</pre></body></html></div>
</div>
<div id="pagination-handling-multi-page-responses" class="section level2">
<h2 class="hasAnchor">
<a href="#pagination-handling-multi-page-responses" class="anchor"></a>Pagination (handling multi-page responses)</h2>
<p>One particularly frustrating aspect of many APIs is dealing with paginated responses. This is common in APIs that offer search functionality and have the potential to return a very large number of responses. Responses might be paginated because there is a large number of response elements or because elements are updated frequently. Often they will be sorted by an explicit or implicit argument specified in the request.</p>
<p>When a response is paginated, the API response will typically respond with a header or value specified in the body that contains one of the following:</p>
<ol style="list-style-type: decimal">
<li>The total number of pages of responses</li>
<li>The total number of response elements (with multiple elements per page)</li>
<li>An indicator for whether any further elements or pages are available.</li>
<li>A URL containing the next page</li>
</ol>
<p>These values can then be used to make further requests. This will either involve specifying a specific page of responses or specifying a “next page token” that returns the next page of results. How to deal with pagination is a difficult question and a client could implement any of the following:</p>
<ol style="list-style-type: decimal">
<li>Return one page only by default with an option to return additional specific pages</li>
<li>Return a specified page (defaulting to 1) and require the end user to handle pagination</li>
<li>Return all pages by writing an internal process of checking for further pages and combining the results</li>
</ol>
<p>The choice of which to use depends on your needs and goals and the rate limits of the API.</p>
<div id="rate-limiting" class="section level3">
<h3 class="hasAnchor">
<a href="#rate-limiting" class="anchor"></a>Rate limiting</h3>
<p>Many APIs are rate limited, which means that you can only send a certain number of requests per hour. Often if your request is rate limited, the error message will tell you how long you should wait before performing another request. You might want to expose this to the user, or even include a call to <code><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep()</a></code> that waits long enough.</p>
<p>For example, we could implement a <code>rate_limit()</code> function that tells you how many calls against the github API are available to you.</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">rate_limit</span> <span class="kw">&lt;-</span> <span class="kw">function</span>() {
  <span class="fu">github_api</span>(<span class="st">"/rate_limit"</span>)
}
<span class="fu">rate_limit</span>()
<span class="co">#&gt; &lt;GitHub /rate_limit&gt;</span>
<span class="co">#&gt; List of 2</span>
<span class="co">#&gt;  $ resources:List of 4</span>
<span class="co">#&gt;   ..$ core                :List of 3</span>
<span class="co">#&gt;   .. ..$ limit    : int 60</span>
<span class="co">#&gt;   .. ..$ remaining: int 3</span>
<span class="co">#&gt;   .. ..$ reset    : int 1595254845</span>
<span class="co">#&gt;   ..$ graphql             :List of 3</span>
<span class="co">#&gt;   .. ..$ limit    : int 0</span>
<span class="co">#&gt;   .. ..$ remaining: int 0</span>
<span class="co">#&gt;   .. ..$ reset    : int 1595254990</span>
<span class="co">#&gt;   ..$ integration_manifest:List of 3</span>
<span class="co">#&gt;   .. ..$ limit    : int 5000</span>
<span class="co">#&gt;   .. ..$ remaining: int 5000</span>
<span class="co">#&gt;   .. ..$ reset    : int 1595254990</span>
<span class="co">#&gt;   ..$ search              :List of 3</span>
<span class="co">#&gt;   .. ..$ limit    : int 10</span>
<span class="co">#&gt;   .. ..$ remaining: int 9</span>
<span class="co">#&gt;   .. ..$ reset    : int 1595251439</span>
<span class="co">#&gt;  $ rate     :List of 3</span>
<span class="co">#&gt;   ..$ limit    : int 60</span>
<span class="co">#&gt;   ..$ remaining: int 3</span>
<span class="co">#&gt;   ..$ reset    : int 1595254845</span></pre></body></html></div>
<p>After getting the first version working, you’ll often want to polish the output to be more user friendly. For this example, we can parse the unix timestamps into more useful date types.</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">rate_limit</span> <span class="kw">&lt;-</span> <span class="kw">function</span>() {
  <span class="no">req</span> <span class="kw">&lt;-</span> <span class="fu">github_api</span>(<span class="st">"/rate_limit"</span>)
  <span class="no">core</span> <span class="kw">&lt;-</span> <span class="no">req</span>$<span class="no">content</span>$<span class="no">resources</span>$<span class="no">core</span>

  <span class="no">reset</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span>(<span class="no">core</span>$<span class="no">reset</span>, <span class="kw">origin</span> <span class="kw">=</span> <span class="st">"1970-01-01"</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="no">core</span>$<span class="no">remaining</span>, <span class="st">" / "</span>, <span class="no">core</span>$<span class="no">limit</span>,
    <span class="st">" (Resets at "</span>, <span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strftime</a></span>(<span class="no">reset</span>, <span class="st">"%H:%M:%S"</span>), <span class="st">")\n"</span>, <span class="kw">sep</span> <span class="kw">=</span> <span class="st">""</span>)
}

<span class="fu">rate_limit</span>()
<span class="co">#&gt; 3 / 60 (Resets at 14:20:45)</span></pre></body></html></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="http://hadley.nz">Hadley Wickham</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
